<rest ldapbase="dc=calvados,dc=fr">

	<resource name="agent" ldapbase="ou=internes,ou=personnes" ldapkey="cn">
		<representation name="default" updatable="true">
			<attribute ldapname="employeeNumber"			name="num-employe" 	readonly="true"/>
			<attribute ldapname="title"						name="civilite" 	type="enum"		required="true" values="M.,Mme,Mlle"/>
			<attribute ldapname="sn"						name="nom"			type="string" 	required="true" maxlength="32"/> 
			<attribute ldapname="givenName"					name="prenom"		type="string"	required="true" maxlength="32"/> 
			<attribute ldapname="mail"						name="mail"			readonly="true"/>
			<attribute ldapname="mobile"					name="tel-mobile" 	type="string"  	format="##.##.##.##.##"/>
			<attribute ldapname="telephoneNumber"			name="tel-externe"/>
			<attribute ldapname="homePhone"					name="tel-interne"/>
			<attribute ldapname="telexNumber"				name="tel-fax"/>
		</representation>
		
		
		<representation name="full" extends="default">
			<attribute ldapname="cg14InterneMission"		name="mission"/>
			<attribute ldapname="description"				name="description"/>
			<attribute ldapname="displayName"				name="nom-complet"/>
			<attribute ldapname="roomNumber"				name="num-bureau"/>
			<attribute ldapname="jpegPhoto	"				name="photo" 			type="file" 	contentType="image/jpeg"/>
			<attribute ldapname="cg14IndicCptActif"			name="actif"/>
			<attribute ldapname="cg14InterneFonction"		name="metier"			type="resource" resource="metier"/> 
			<attribute ldapname="cg14InterneSpecialite"		name="emploi"			type="resource" resource="emploi"/>
			
			<attribute ldapname="cg14InterneService"		name="services"			type="resource" resource="service" 		multiple="true"/> 
			<attribute ldapname="cg14Localisation"			name="localisations"	type="resource" resource="localisation" multiple="true"/>
			<attribute ldapname="seeAlso" 					name="groupes"			type="resource" resource="groupe" 		multiple="true"/>
		</representation>
		
		<query>
			<param name="nomPrenom" operand="OR">
				<attribute ldapname="sn" filter="WhitespaceWildcardsFilter"/>
				<attribute ldapname="givenName" filter="WhitespaceWildcardsFilter"/>
				<attribute ldapname="displayName" filter="WhitespaceWildcardsFilter"/>
			</param>
			<param name="metier" operand="AND">
				<attribute ldapname="cg14InterneFonction" filter="EqualsFilter" type="resource" resource="metier"/>
			</param>
			<param name="localisation" operand="AND">
				<attribute ldapname="cg14Localisation" filter="EqualsFilter" type="resource" resource="localisation"/>
			</param>
		</query>
	</resource>

	<resource name="metier" ldapbase="ou=fonctions" ldapkey="cn">
		<representation name="default">
			<attribute ldapname="businessCategory"			name="libelle" 	type="string"/>
			<attribute ldapname="member"					name="membres" 	type="resource" resource="agent" multiple="true"/>
		</representation>
	</resource>
	
	<resource name="emploi" ldapbase="ou=specialites" ldapkey="cn">
		<representation name="default">
			<attribute ldapname="businessCategory"			name="libelle" 	type="string"/>
			<attribute ldapname="member"					name="membres" 	type="resource" resource="agent" multiple="true"/>
		</representation>
	</resource>
	
	<resource name="groupe" ldapbase="ou=groupes" ldapkey="cn">
		<representation name="default">
			<attribute ldapname="businessCategory"			name="libelle" 	type="string"/>
			<attribute ldapname="member"					name="membres" 	type="resource" resource="agent" multiple="true"/>
		</representation>
		
		
		<query representation="default">
			<param name="libelle">
				<attribute ldapname="businessCategory" filter="LikeFilter"/>
			</param>
		</query>
		
	</resource>
	
	<resource name="localisation" ldapbase="ou=localisations" ldapkey="o">
		<representation name="default">
			<attribute ldapname="businessCategory"			name="libelle" 	type="string"/>
			<attribute ldapname="member"					name="membres" 	type="resource" resource="agent" multiple="true"/>
		</representation>
		
		
		<query representation="default">
			<param name="libelle">
				<attribute ldapname="businessCategory" filter="LikeFilter"/>
			</param>
		</query>
	</resource>	

	<resource name="service" ldapbase="ou=directions,ou=organigramme" ldapkey="ou" subresource="true">
		<representation name="default" allattributes="true">
		</representation>
		
		<query representation="default">
			<param name="libelle">
				<attribute ldapname="businessCategory" filter="LikeFilter"/>
			</param>
		</query>
	</resource>
	

	<resource name="ldap" ldapkey="ou" subresource="true">
		<representation name="default" allattributes="true" />
	</resource>
</rest>